<!-- Adds library of choice -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/2.6.5/svg.min.js"></script>
<div id="badge"></div>
<script type="application/javascript">
(async () => {
let defaults = {
  title: 'badge.dog',
  shieldTitle: 'HTML',
  shieldBg: '#E34C26',
  shieldShadow: '#F06529',
  shieldCharacter: 'five',
  googleFontName: 'Montserrat'
}


function sleep (ms) {
  return new Promise(resolve => setTimeout(resolve, ms))
}

let config = defaults
// cast opts
var svg = SVG('badge')
var element = svg.element('title').words(config.title)
let defs = svg.defs()
// meh
let cssRaw = await fetch(`http://localhost:3100/utils/encodefont/${config.googleFontName}?text=${config.shieldTitle}%20${config.shieldCharacter}`)
let css = await cssRaw.text()
defs.node.innerHTML = `
  <style type="text/css">
    ${css}
  </style>
  `
  
let shieldContentPaths = {
  tree: 'M20 30 L75 30 L73 58 L21.5 58  L73 58 L71.9 81 L50 90 L29 81 L28.1 70',
  five: 'M80 30 L 26 30 L27 58 L73 58 L72 81 L50 90 L29 81 L28.1 70',
  eight: 'M50 30 L 26 30 L27.6 58 L72.5 58  L74 30 L50 30 L 26 30  L29 81 L50 90 L71.8 80 L74 30'
}
let shieldPath = 'M0 0 L100 0 L95 100 L50 120 L5 100 Z';
let shieldShadow = 'M90 10 L 50 10 L 50 110 L87 94';



svg.path(shieldPath).fill(config.shieldBg)
svg.path(shieldShadow).fill(config.shieldShadow)
svg.path(shieldContentPaths[config.shieldCharacter]).stroke({ width: 12, color: '#FFF' }).fill('none')
svg.size(120)

})()
</script>


